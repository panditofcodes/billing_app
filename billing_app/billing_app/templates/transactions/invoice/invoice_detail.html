{% extends 'base_details.html' %}

{% block title %}{{ title }}{% endblock %}
{% block page_title %}{{ title }}{% endblock %}

{% block content %}
<div class="card shadow-sm">
  <div class="card-body">
    <h4 class="card-title mb-3">
      Invoice #{{ invoice.invoice_number }}
    </h4>

    <table class="table table-bordered table-sm">
      <tr>
        <th width="25%">Invoice Number</th>
        <td>{{ invoice.invoice_number }}</td>
      </tr>
      <tr>
        <th>Company</th>
        <td>{{ invoice.company.name }}</td>
      </tr>
      <tr>
        <th>Customer</th>
        <td>{{ invoice.customer.name }}</td>
      </tr>
      <tr>
        <th>Subtotal</th>
        <td>₹{{ invoice.subtotal }}</td>
      </tr>
      <tr>
        <th>GST Total</th>
        <td>₹{{ invoice.gst_total }}</td>
      </tr>
      <tr>
        <th>Grand Total</th>
        <td><strong>₹{{ invoice.grand_total }}</strong></td>
      </tr>
      <tr>
        <th>Created On</th>
        <td>{{ invoice.created_at|date:"d M Y, h:i A" }}</td>
      </tr>
    </table>

    <h5 class="mt-4 mb-2">Items</h5>
    <table class="table table-bordered table-sm align-middle">
      <thead class="table-light">
        <tr>
          <th>Item</th>
          <th>HSN</th>
          <th>Quantity</th>
          <th>Price</th>
          <th>GST (%)</th>
          <th>Total</th>
        </tr>
      </thead>
      <tbody>
        {% for item in invoice.items.all %}
          <tr>
            <td>{{ item.item.name }}</td>
            <td>{{ item.item.hsn_code|default:"—" }}</td>
            <td>{{ item.quantity }}</td>
            <td>₹{{ item.price }}</td>
            <td>{{ item.gst_rate }}%</td>
            <td>₹{{ item.total }}</td>
          </tr>
        {% empty %}
          <tr>
            <td colspan="6" class="text-center text-muted">No items found.</td>
          </tr>
        {% endfor %}
      </tbody>
    </table>

    <div class="d-flex justify-content-end mt-3">
      <a href="{{ edit_url }}" class="btn btn-outline-primary me-2">
        <i class="bi bi-pencil"></i> Edit
      </a>

      <a href="{% url 'invoice_print' invoice.id %}" target="_blank" class="btn btn-outline-success me-2">
        <i class="bi bi-printer"></i> Print Invoice
      </a>

      <button
        class="btn btn-outline-danger me-2"
        data-bs-toggle="modal"
        data-bs-target="#deleteModal"
      >
        <i class="bi bi-trash"></i> Delete
      </button>

      <a href="{{ back_url }}" class="btn btn-outline-secondary">
        <i class="bi bi-arrow-left"></i> Back
      </a>
    </div>
  </div>
</div>

{% include 'includes/modal_delete.html' with delete_url=delete_url object_name=object_name %}
{% endblock %}
